rules:
  - id: grape-route
    patterns:
      - pattern: $FUNC ...
      - pattern-inside: |
          class $CLASS < $PARENT
            ...
          end
      - metavariable-pattern:
          metavariable: $FUNC
          pattern-either:
            - pattern: resource
            - pattern: resources
            - pattern: get
            - pattern: patch
            - pattern: put
            - pattern: post
            - pattern: delete
      - metavariable-pattern:
          metavariable: $PARENT
          pattern-either:
            - pattern: Grape::API
            - pattern: Grape::API::Instance
            - pattern: ::API::Base
    message: Found Grape route
    metadata:
      references:
        - https://github.com/ruby-grape/grape
      route-detect:
        fill: grey
    languages: [ruby]
    severity: INFO
