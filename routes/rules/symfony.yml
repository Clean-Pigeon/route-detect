rules:
  - id: symfony-route-unauthenticated
    pattern-either:
      - pattern: Symfony\Component\Routing\Annotation\Route($PATH, ...)
      - patterns:
          - pattern: $ROUTES->add($NAME, $PATH, ...);
          - pattern-inside: function (Symfony\Component\Routing\Loader\Configurator\RoutingConfigurator $ROUTES) { ... }
    message: Found unauthenticated Symfony route
    metadata:
      references:
        - https://symfony.com/doc/current/routing.html
      route-detect:
        fill: red
    languages: [php]
    severity: INFO
  - id: symfony-route-unauthenticated-yaml
    pattern: |
      $NAME:
        ...
        path: $PATH
        ...
        controller: $CONTROLLER
        ...
    paths:
      include:
        - "symfony.test.yaml" # For testing purposes only
        - "routes.yaml"
        - "routes.yml"
    message: Found unauthenticated Symfony route
    metadata:
      references:
        - https://symfony.com/doc/current/routing.html
      route-detect:
        fill: red
    languages: [yaml]
    severity: INFO
